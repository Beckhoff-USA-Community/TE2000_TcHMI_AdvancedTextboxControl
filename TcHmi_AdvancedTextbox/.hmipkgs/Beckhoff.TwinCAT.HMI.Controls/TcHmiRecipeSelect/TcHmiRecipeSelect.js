var TcHmi,__extends=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();!function(e){!function(t){!function(t){var r=function(t){function r(e,r,o){var i=t.call(this,e,r,o)||this;i.__serverDomainDestroyWatchCallback=null,i.__serverDomainIsValid=!1,i.__buttonActivate=null,i.__buttonTeach=null,i.__topMostButtonOK=null,i.__topMostButtonCancel=null,i.__destroyButtonActivateOnPressed=null,i.__destroyButtonTeachOnPressed=null,i.__destroyTopMostButtonOKOnPressed=null,i.__destroyTopMostButtonCancelPressed=null,i.__currentSelectionFolderTemp=null,i.__currentSelectionRecipeTemp=null,i.__currentSelectionFolder=null,i.__currentSelectionRecipe=null,i.__breadcrumbScrollingMouseDown=!1,i.__topMostLayerOpened=!1,i.__breadcrumbItems=[],i.__subscrIdGetActiveRecipes=null,i.__subscrIdCurrentSelectionFolderRecipes=null;var n=document.createElement("div");return n.innerHTML='<div class="TcHmi_Controls_Beckhoff_TcHmiRecipeSelect_topmost_selection"><h1>Recipes</h1><div class="TcHmi_Controls_Beckhoff_TcHmiRecipeSelect_topmost_selection_list"></div></div>',i.__elementTopMostSelection=n.firstElementChild,i.__elementTopMostSelection&&(i.__elementTopMostSelectionList=i.__elementTopMostSelection.querySelector(".TcHmi_Controls_Beckhoff_TcHmiRecipeSelect_topmost_selection_list")),i}return __extends(r,t),r.prototype.__previnit=function(){if(this.__elementTemplateRoot=this.__element[0].querySelector(".TcHmi_Controls_Beckhoff_TcHmiRecipeSelect-template"),!this.__elementTemplateRoot)throw new Error("Invalid Template.html - Missing element with class: 'TcHmi_Controls_Beckhoff_TcHmiRecipeSelect-template'.");if(this.__elementSelectDiv=this.__elementTemplateRoot.querySelector(".TcHmi_Controls_Beckhoff_TcHmiRecipeSelect-table-1-row-1-cell-1"),!this.__elementSelectDiv)throw new Error("Invalid Template.html - Missing element with class: 'TcHmi_Controls_Beckhoff_TcHmiRecipeSelect-table-1-row-1-cell-1'.");if(this.__elementBreadcrumbScrollContainer=this.__elementTemplateRoot.querySelector(".TcHmi_Controls_Beckhoff_TcHmiRecipeSelect-breadcrumb-scroll-container"),!this.__elementBreadcrumbScrollContainer)throw new Error("Invalid Template.html - Missing element with class: 'TcHmi_Controls_Beckhoff_TcHmiRecipeSelect-breadcrumb-scroll-container'.");if(this.__elementBreadcrumbList=this.__elementTemplateRoot.querySelector(".TcHmi_Controls_Beckhoff_TcHmiRecipeSelect-breadcrumb-list"),!this.__elementBreadcrumbList)throw new Error("Invalid Template.html - Missing element with class: 'TcHmi_Controls_Beckhoff_TcHmiRecipeSelect-breadcrumb-list'.");t.prototype.__previnit.call(this)},r.prototype.__init=function(){if(!this.__elementTemplateRoot)throw new Error("Invalid Template.html - Missing element with class: 'TcHmi_Controls_Beckhoff_TcHmiRecipeSelect-template'.");if(!this.__elementSelectDiv)throw new Error("Invalid Template.html - Missing element with class: 'TcHmi_Controls_Beckhoff_TcHmiRecipeSelect-table-1-row-1-cell-1'.");if(!this.__elementBreadcrumbScrollContainer)throw new Error("Invalid Template.html - Missing element with class: 'TcHmi_Controls_Beckhoff_TcHmiRecipeSelect-breadcrumb-scroll-container'.");if(!this.__elementBreadcrumbList)throw new Error("Invalid Template.html - Missing element with class: 'TcHmi_Controls_Beckhoff_TcHmiRecipeSelect-breadcrumb-list'.");TCHMI_DESIGNER||(this.__elementSelectDivMouseDownListener=this.__onSelectDivMouseDown(),this.__elementSelectDiv.addEventListener("mousedown",this.__elementSelectDivMouseDownListener,{passive:!1,capture:!1}),this.__elementBreadcrumbScrollContainerMouseDownListener=this.__onBreadcrumbScrollingContainerMouseDown(),this.__elementBreadcrumbScrollContainer.addEventListener("mousedown",this.__elementBreadcrumbScrollContainerMouseDownListener,{passive:!1,capture:!1}),this.__documentMouseUpListener=this.__onDocumentMouseUp(),window.document.addEventListener("mouseup",this.__documentMouseUpListener,{passive:!1,capture:!1}),this.__documentMouseMoveListener=this.__onDocumentMouseMove(),window.document.addEventListener("mousemove",this.__documentMouseMoveListener,{passive:!1,capture:!1}));var r=this.__elementTemplateRoot.querySelector(".TcHmi_Controls_Beckhoff_TcHmiRecipeSelect-table-1-row-1-cell-2");this.__buttonActivate=e.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",this.__id+"_ButtonActivate",{"data-tchmi-left":"0","data-tchmi-top":"0","data-tchmi-right":"0","data-tchmi-bottom":"0","data-tchmi-text":"Activate","data-tchmi-tooltip":"Activate recipe","data-tchmi-text-font-size-unit":"px","data-tchmi-text-font-style":"Auto","data-tchmi-text-font-weight":"Auto"},this),TCHMI_DESIGNER||(this.__destroyButtonActivateOnPressed=e.EventProvider.register(this.__id+"_ButtonActivate.onPressed",this.__onButtonActivePressed())),this.__buttonActivate&&r&&r.appendChild(this.__buttonActivate.getElement()[0]);var o=this.__elementTemplateRoot.querySelector(".TcHmi_Controls_Beckhoff_TcHmiRecipeSelect-table-1-row-1-cell-3");this.__buttonTeach=e.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",this.__id+"_ButtonTeach",{"data-tchmi-left":"0","data-tchmi-top":"0","data-tchmi-right":"0","data-tchmi-bottom":"0","data-tchmi-text":"Teach","data-tchmi-tooltip":"Teach recipe","data-tchmi-text-font-size-unit":"px","data-tchmi-text-font-style":"Auto","data-tchmi-text-font-weight":"Auto"},this),TCHMI_DESIGNER||(this.__destroyButtonTeachOnPressed=e.EventProvider.register(this.__id+"_ButtonTeach.onPressed",this.__onButtonTeachPressed())),this.__buttonTeach&&o&&o.appendChild(this.__buttonTeach.getElement()[0]),this.__topMostButtonOK=e.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",this.__id+"_TopMostButtonOK",{"data-tchmi-text":"Ok","data-tchmi-width":"75","data-tchmi-height":"35","data-tchmi-right":"90"},this),TCHMI_DESIGNER||(this.__destroyTopMostButtonOKOnPressed=e.EventProvider.register(this.__id+"_TopMostButtonOK.onPressed",this.__onTopMostButtonOKPressed())),this.__topMostButtonCancel=e.ControlFactory.createEx("TcHmi.Controls.Beckhoff.TcHmiButton",this.__id+"_TopMostButtonCancel",{"data-tchmi-text":"Cancel","data-tchmi-width":"75","data-tchmi-height":"35","data-tchmi-right":"10"},this),TCHMI_DESIGNER||(this.__destroyTopMostButtonCancelPressed=e.EventProvider.register(this.__id+"_TopMostButtonCancel.onPressed",this.__onTopMostButtonCancelPressed())),this.__elementTopMostSelection&&this.__topMostButtonOK&&this.__elementTopMostSelection.appendChild(this.__topMostButtonOK.getElement()[0]),this.__elementTopMostSelection&&this.__topMostButtonCancel&&this.__elementTopMostSelection.appendChild(this.__topMostButtonCancel.getElement()[0]),TCHMI_DESIGNER||this.__processSelection(),t.prototype.__init.call(this)},r.prototype.__attach=function(){!TCHMI_DESIGNER&&this.__serverDomain&&(this.__serverDomainDestroyWatchCallback=e.Server.Domains.watch(this.__serverDomain,this.__onServerDomainWatchCallback())),t.prototype.__attach.call(this)},r.prototype.__detach=function(){this.__serverDomainDestroyWatchCallback&&(this.__serverDomainDestroyWatchCallback(),this.__serverDomainDestroyWatchCallback=null),this.__unwatchActiveRecipes(),this.__serverDomainIsValid=!1,t.prototype.__detach.call(this)},r.prototype.destroy=function(){this.__keepAlive||(this.__destroyButtonActivateOnPressed&&(this.__destroyButtonActivateOnPressed(),this.__destroyButtonActivateOnPressed=null),this.__destroyButtonTeachOnPressed&&(this.__destroyButtonTeachOnPressed(),this.__destroyButtonTeachOnPressed=null),this.__destroyTopMostButtonOKOnPressed&&(this.__destroyTopMostButtonOKOnPressed(),this.__destroyTopMostButtonOKOnPressed=null),this.__destroyTopMostButtonCancelPressed&&(this.__destroyTopMostButtonCancelPressed(),this.__destroyTopMostButtonCancelPressed=null),this.__elementSelectDiv&&this.__elementSelectDivMouseDownListener&&(this.__elementSelectDiv.removeEventListener("mousedown",this.__elementSelectDivMouseDownListener),this.__elementSelectDivMouseDownListener=null),this.__elementBreadcrumbScrollContainer&&this.__elementBreadcrumbScrollContainerMouseDownListener&&(this.__elementBreadcrumbScrollContainer.removeEventListener("mousedown",this.__elementBreadcrumbScrollContainerMouseDownListener),this.__elementBreadcrumbScrollContainerMouseDownListener=null),this.__documentMouseUpListener&&(window.document.removeEventListener("mouseup",this.__documentMouseUpListener),this.__documentMouseUpListener=null),this.__documentMouseMoveListener&&(window.document.addEventListener("mousemove",this.__documentMouseMoveListener,{passive:!1,capture:!1}),this.__documentMouseMoveListener=null),this.__serverDomainDestroyWatchCallback&&(this.__serverDomainDestroyWatchCallback(),this.__serverDomainDestroyWatchCallback=null),e.TopMostLayer.remove(this,$(this.__elementTopMostSelection)),t.prototype.destroy.call(this))},r.prototype.__onServerDomainWatchCallback=function(){var t=this;return function(r){r&&r.error===e.Errors.NONE?r.value&&!0===r.value.loaded?(t.setIsEnabled(!0),t.__serverDomainIsValid=!0,t.__watchActiveRecipes()):(t.setIsEnabled(!1),t.__serverDomainIsValid=!1,t.__unwatchActiveRecipes(),e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiRecipeSelect, Id="+t.getId()+"] Domain: '"+t.__serverDomain+"' is not loaded. Please make sure the server extension is activated.")):(t.setIsEnabled(!1),t.__serverDomainIsValid=!1,t.__unwatchActiveRecipes(),e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiRecipeSelect, Id="+t.getId()+"] Domain: '"+t.__serverDomain+"' is not known. Please make sure the server extension is loaded and the domain name is correct."))}},r.prototype.__processAccessConfig=function(){var r,o,i,n;t.prototype.__processAccessConfig.call(this);var c=e.Access.checkAccess(this,"teachRecipe");null===c&&(c=!1),null===(r=this.__buttonTeach)||void 0===r||r.getElement()[0].classList.toggle("TcHmi_Controls_System_TcHmiControl-operate-disallowed",!c),null===(o=this.__buttonTeach)||void 0===o||o.setIsEnabled(c);var s=e.Access.checkAccess(this,"activateRecipe");null===s&&(s=!1),null===(i=this.__buttonActivate)||void 0===i||i.getElement()[0].classList.toggle("TcHmi_Controls_System_TcHmiControl-operate-disallowed",!s),null===(n=this.__buttonActivate)||void 0===n||n.setIsEnabled(s)},r.prototype.setServerDomain=function(valueNew){var t=e.ValueConverter.toString(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("ServerDomain")),tchmi_equal(t,this.__serverDomain)||(this.__serverDomain=t,e.EventProvider.raise(this.__id+".onFunctionResultChanged",["getServerDomain"]),this.__processServerDomain())},r.prototype.getServerDomain=function(){return this.__serverDomain},r.prototype.__processServerDomain=function(){!1!==this.__isAttached&&(this.__unwatchActiveRecipes(),this.__serverDomainDestroyWatchCallback&&(this.__serverDomainDestroyWatchCallback(),this.__serverDomainDestroyWatchCallback=null),!TCHMI_DESIGNER&&this.__serverDomain&&(this.__serverDomainDestroyWatchCallback=e.Server.Domains.watch(this.__serverDomain,this.__onServerDomainWatchCallback())))},r.prototype.setServerInterval=function(valueNew){var t=e.ValueConverter.toNumber(valueNew);null===t&&(t=this.getAttributeDefaultValueInternal("ServerInterval")),tchmi_equal(t,this.__serverInterval)||(this.__serverInterval=t,e.EventProvider.raise(this.__id+".onFunctionResultChanged",["getServerInterval"]),this.__processServerInterval())},r.prototype.getServerInterval=function(){return this.__serverInterval},r.prototype.__processServerInterval=function(){this.__unwatchActiveRecipes(),this.__watchActiveRecipes()},r.prototype.getSelectedRecipeFullName=function(){return this.__currentSelectionRecipe&&this.__currentSelectionRecipe.key?this.__currentSelectionRecipe.path?this.__currentSelectionRecipe.path+"::"+this.__currentSelectionRecipe.key:this.__currentSelectionRecipe.key:null},r.prototype.getSelectedRecipeName=function(){return this.__currentSelectionRecipe&&this.__currentSelectionRecipe.key?this.__currentSelectionRecipe.key:null},r.prototype.getSelectedRecipePath=function(){return this.__currentSelectionRecipe&&this.__currentSelectionRecipe.path?this.__currentSelectionRecipe.path:null},r.prototype.__watchActiveRecipes=function(){var t=this;if(!TCHMI_DESIGNER&&this.__isAttached&&null===this.__subscrIdGetActiveRecipes){var r=this.__serverDomain;r||(r="TcHmiRecipeManagement");var o=this.__serverInterval;o||(o=0);var i=r+".GetActiveRecipes";this.__subscrIdGetActiveRecipes=e.Server.subscribe([{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:i}],o,function(o){if(o.error===e.Errors.NONE){var n=o.response;if(!n)return void e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiRecipeSelect, Id="+t.getId()+"] "+r+".GetActiveRecipes: "+e.Log.buildMessage({code:e.Errors.E_SERVER_RESPONSE_MISSING,message:e.Errors[e.Errors.E_SERVER_RESPONSE_MISSING],reason:"Missing response from server.",domain:"TcHmi.Controls.Beckhoff.TcHmiRecipeSelect"}));if(n.error)return void e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiRecipeSelect, Id="+t.getId()+"] "+r+".GetActiveRecipes: "+e.Log.buildMessage({code:e.Errors.E_SERVER_RESPONSE_ERROR,message:e.Errors[e.Errors.E_SERVER_RESPONSE_ERROR],reason:"Error in response from server with id: '"+n.id+"'.",domain:"TcHmi.Controls.Beckhoff.TcHmiRecipeSelect",errors:[n.error]}));var c=n.commands;if(!c)return void e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiRecipeSelect, Id="+t.getId()+"] "+r+".GetActiveRecipes: "+e.Log.buildMessage({code:e.Errors.E_SERVER_COMMANDS_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMANDS_MISSING],reason:"Missing commands in response from server with id: '"+n.id+"'.",domain:"TcHmi.Controls.Beckhoff.TcHmiRecipeSelect"}));for(var s=null,l=0,_=c.length;l<_;l++){if((s=c[l]).symbol===i){if(s.error)return void e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiRecipeSelect, Id="+t.getId()+"] "+r+".GetActiveRecipes: "+e.Log.buildMessage({code:e.Errors.E_SERVER_COMMAND_ERROR,message:e.Errors[e.Errors.E_SERVER_COMMAND_ERROR],reason:"Error in command for symbol: '"+r+".GetActiveRecipes' in response from server with id: '"+n.id+"'.",domain:"TcHmi.Controls.Beckhoff.TcHmiRecipeSelect",errors:[s.error]}));break}s=null}if(!s)return void e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiRecipeSelect, Id="+t.getId()+"] "+r+".GetActiveRecipes: "+e.Log.buildMessage({code:e.Errors.E_SERVER_COMMAND_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMAND_MISSING],reason:"Missing command for symbol: '"+i+"' in response from server with id: '"+n.id+"'.",domain:"TcHmi.Controls.Beckhoff.TcHmiRecipeSelect"}));var a=s.readValue;if(!a)return void e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiRecipeSelect, Id="+t.getId()+"] "+r+".GetActiveRecipes: "+e.Log.buildMessage({code:e.Errors.E_SERVER_READVALUE_MISSING,message:e.Errors[e.Errors.E_SERVER_READVALUE_MISSING],reason:"Missing property: 'readValue' in command for symbol: '"+i+"' in response from server with id: '"+n.id+"'.",domain:"TcHmi.Controls.Beckhoff.TcHmiRecipeSelect"}));if(t.__currentSelectionRecipe){var m=void 0;t.__currentSelectionRecipe&&t.__currentSelectionRecipe.path&&(m||(m=""),m+=t.__currentSelectionRecipe.path),t.__currentSelectionRecipe&&t.__currentSelectionRecipe.key&&(m?m+="::":m="",m+=t.__currentSelectionRecipe.key),o&&a&&m&&a.indexOf(m)>-1?t.__elementSelectDiv&&t.__elementSelectDiv.classList.add("TcHmi_Controls_Beckhoff_TcHmiRecipeSelect-table-1-row-1-cell-1-active"):t.__elementSelectDiv&&t.__elementSelectDiv.classList.remove("TcHmi_Controls_Beckhoff_TcHmiRecipeSelect-table-1-row-1-cell-1-active")}}else e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiRecipeSelect, Id="+t.getId()+"] "+r+".GetActiveRecipes: "+e.Log.buildMessage(o.details)),t.__elementSelectDiv&&t.__elementSelectDiv.classList.remove("TcHmi_Controls_Beckhoff_TcHmiRecipeSelect-table-1-row-1-cell-1-active")})}},r.prototype.__unwatchActiveRecipes=function(){null!==this.__subscrIdGetActiveRecipes&&(e.Server.unsubscribe(this.__subscrIdGetActiveRecipes),this.__subscrIdGetActiveRecipes=null)},r.prototype.__watchCurrentSelectionFolderRecipes=function(){var t=this;if(!TCHMI_DESIGNER&&this.__isAttached&&null===this.__subscrIdCurrentSelectionFolderRecipes){var r=this.__serverDomain;r||(r="TcHmiRecipeManagement");var o=this.__serverInterval;o||(o=0);var path=null;this.__currentSelectionFolder&&(path="",this.__currentSelectionFolder.path&&(path+=this.__currentSelectionFolder.path+"::"),this.__currentSelectionFolder.key&&(path+=this.__currentSelectionFolder.key));var i=r+".Config::recipeList";path&&(i+="::"+path),this.__subscrIdCurrentSelectionFolderRecipes=e.Server.subscribe([{commandOptions:["SendErrorMessage","SendWriteValue"],symbol:i}],o,function(r){if(r.error===e.Errors.NONE){var o=r.response;if(!o)return void e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiRecipeSelect, Id="+t.getId()+"] Current folder recipe watching failed with error: "+e.Log.buildMessage({code:e.Errors.E_SERVER_RESPONSE_MISSING,message:e.Errors[e.Errors.E_SERVER_RESPONSE_MISSING],reason:"Missing response from server.",domain:"TcHmi.Controls.Beckhoff.TcHmiRecipeSelect"}));if(o.error)return void e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiRecipeSelect, Id="+t.getId()+"] Current folder recipe watching failed with error: "+e.Log.buildMessage({code:e.Errors.E_SERVER_RESPONSE_ERROR,message:e.Errors[e.Errors.E_SERVER_RESPONSE_ERROR],reason:"Error in response from server with id: '"+o.id+"'.",domain:"TcHmi.Controls.Beckhoff.TcHmiRecipeSelect",errors:[o.error]}));var n=o.commands;if(!n)return void e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiRecipeSelect, Id="+t.getId()+"] Current folder recipe watching failed with error: "+e.Log.buildMessage({code:e.Errors.E_SERVER_COMMANDS_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMANDS_MISSING],reason:"Missing commands in response from server with id: '"+o.id+"'.",domain:"TcHmi.Controls.Beckhoff.TcHmiRecipeSelect"}));for(var c=null,s=0,l=n.length;s<l;s++){if((c=n[s]).symbol===i){if(c.error&&512!==c.error.code)return void e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiRecipeSelect, Id="+t.getId()+"] Current folder recipe watching failed with error: "+e.Log.buildMessage({code:e.Errors.E_SERVER_COMMAND_ERROR,message:e.Errors[e.Errors.E_SERVER_COMMAND_ERROR],reason:"Error in command for symbol: '"+i+"' in response from server with id: '"+o.id+"'.",domain:"TcHmi.Controls.Beckhoff.TcHmiRecipeSelect",errors:[c.error]}));c.error&&512===c.error.code&&(t.__currentSelectionFolder=null,t.__currentSelectionRecipe=null,t.__processSelection());break}c=null}if(!c)return void e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiRecipeSelect, Id="+t.getId()+"] Current folder recipe watching failed with error: "+e.Log.buildMessage({code:e.Errors.E_SERVER_COMMAND_MISSING,message:e.Errors[e.Errors.E_SERVER_COMMAND_MISSING],reason:"Missing command for symbol: '"+i+"' in response from server with id: '"+o.id+"'.",domain:"TcHmi.Controls.Beckhoff.TcHmiRecipeSelect"}));var _=c.readValue;if(!_)return void e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiRecipeSelect, Id="+t.getId()+"] Current folder recipe watching failed with error: "+e.Log.buildMessage({code:e.Errors.E_SERVER_READVALUE_MISSING,message:e.Errors[e.Errors.E_SERVER_READVALUE_MISSING],reason:"Missing property: 'readValue' in command for symbol: '"+i+"' in response from server with id: '"+o.id+"'.",domain:"TcHmi.Controls.Beckhoff.TcHmiRecipeSelect"}));t.__currentSelectionRecipe&&t.__currentSelectionRecipe.key&&r&&_&&!_[t.__currentSelectionRecipe.key]&&(t.__currentSelectionRecipe=null,t.__processSelection())}else e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiRecipeSelect, Id="+t.getId()+"] Current folder recipe watching failed with error: "+e.Log.buildMessage(r.details))})}},r.prototype.__unwatchCurrentSelectionFolderRecipes=function(){null!==this.__subscrIdCurrentSelectionFolderRecipes&&(e.Server.unsubscribe(this.__subscrIdCurrentSelectionFolderRecipes),this.__subscrIdCurrentSelectionFolderRecipes=null)},r.prototype.__processSelection=function(){if(!TCHMI_DESIGNER){this.__currentSelectionFolder&&this.__currentSelectionRecipe?this.__elementSelectDiv&&this.__currentSelectionRecipe.key&&(this.__elementSelectDiv.innerText=this.__currentSelectionRecipe.key):this.__elementSelectDiv&&(this.__elementSelectDiv.innerText="Select");for(var e=this.__breadcrumbItems,t=0,o=e.length;t<o;t++){var i=e[t];i&&i.breadcrumbElement&&i.breadcrumbEventListenerClick&&i.breadcrumbElement.removeEventListener("click",i.breadcrumbEventListenerClick)}e.splice(0,e.length);var n=document.createElement("ul");n.innerHTML="<li><a>/</a></li>";var c={type:r.RecipeItemType.Folder,breadcrumbElement:n.firstElementChild};if(c.breadcrumbEventListenerClick=this.__onBreadcrumbItemClicked(c),c.breadcrumbElement&&c.breadcrumbElement.addEventListener("click",c.breadcrumbEventListenerClick),e.push(c),this.__currentSelectionFolder&&this.__elementBreadcrumbList){for(;this.__elementBreadcrumbList.firstChild;)this.__elementBreadcrumbList.removeChild(this.__elementBreadcrumbList.firstChild);var path=this.__currentSelectionFolder.path,s=this.__currentSelectionFolder.key,l="";if(path){var _=path.split("::");for(t=0,o=_.length;t<o;t++){var a=_[t],m=document.createElement("ul");m.innerHTML="<li><a>"+a+"</a></li>";var d={type:r.RecipeItemType.Folder,path:l,key:a,breadcrumbElement:m.firstElementChild};d.breadcrumbEventListenerClick=this.__onBreadcrumbItemClicked(d),d.breadcrumbElement&&d.breadcrumbElement.addEventListener("click",d.breadcrumbEventListenerClick),e.push(d),l.length>0?l+="::"+a:l+=a}}if(s){var u=document.createElement("ul");u.innerHTML="<li><a>"+s+"</a></li>";var p={type:r.RecipeItemType.Folder,path:l,key:s,breadcrumbElement:u.firstElementChild};p.breadcrumbEventListenerClick=this.__onBreadcrumbItemClicked(p),p.breadcrumbElement&&p.breadcrumbElement.addEventListener("click",p.breadcrumbEventListenerClick),e.push(p)}}if(this.__elementBreadcrumbList){var h=document.createDocumentFragment();for(t=0,o=e.length;t<o;t++){var v=e[t];v.breadcrumbElement&&h.appendChild(v.breadcrumbElement)}for(;this.__elementBreadcrumbList&&this.__elementBreadcrumbList.firstChild;)this.__elementBreadcrumbList.removeChild(this.__elementBreadcrumbList.firstChild);this.__elementBreadcrumbList.append(h),this.__elementBreadcrumbScrollContainer&&(this.__elementBreadcrumbScrollContainer.scrollLeft=this.__elementBreadcrumbScrollContainer.clientWidth+1024)}this.__unwatchCurrentSelectionFolderRecipes(),this.__watchCurrentSelectionFolderRecipes()}},r.prototype.__displayTopMostSelectionFolder=function(t,path){if(!TCHMI_DESIGNER&&this.__elementTopMostSelection&&this.__elementTopMostSelectionList&&t){var o=!1;if(path){var i=(d=path.split("::")).pop(),n=void 0;d.length>0&&(n=d.join("::")),this.__currentSelectionFolderTemp={type:r.RecipeItemType.Folder,path:n,key:i,payload:t}}else this.__currentSelectionFolderTemp={type:r.RecipeItemType.Folder,payload:t};for(;this.__elementTopMostSelectionList.firstChild;)this.__elementTopMostSelectionList.removeChild(this.__elementTopMostSelectionList.firstChild);var c=document.createElement("ul");this.__elementTopMostSelectionList.appendChild(c);var s=[],l=[];for(var i in this.__currentSelectionFolderTemp.payload){var _=this.__currentSelectionFolderTemp.payload[i];if(_&&void 0!==_.recipeTypeName){(m=document.createElement("div")).innerHTML='<li class="TcHmi_Controls_Beckhoff_TcHmiRecipeSelect_topmost_selection_item TcHmi_Controls_Beckhoff_TcHmiRecipeSelect_topmost_selection_item_recipe">'+i+"</li>";var a={type:r.RecipeItemType.Recipe,key:i,payload:_,selectionElement:m.firstElementChild};path&&(a.path=path),a.selectionEventListenerClick=this.__onTopMostRecipeItemClicked(a),a.selectionElement&&(a.selectionElement.addEventListener("click",a.selectionEventListenerClick),this.__currentSelectionRecipe&&this.__currentSelectionRecipe.path===a.path&&this.__currentSelectionRecipe.key===a.key&&(a.selectionElement.classList.add("TcHmi_Controls_Beckhoff_TcHmiRecipeSelect_topmost_selected"),this.__currentSelectionRecipe=a,o=!0)),l.push(a)}else{(m=document.createElement("div")).innerHTML='<li class="TcHmi_Controls_Beckhoff_TcHmiRecipeSelect_topmost_selection_item TcHmi_Controls_Beckhoff_TcHmiRecipeSelect_topmost_selection_item_folder">'+i+"</li>";a={type:r.RecipeItemType.Folder,key:i,payload:_,selectionElement:m.firstElementChild};path&&(a.path=path),a.selectionEventListenerClick=this.__onTopMostRecipeItemClicked(a),a.selectionElement&&a.selectionElement.addEventListener("click",a.selectionEventListenerClick),s.push(a)}}if(this.__currentSelectionFolderTemp.key){var m,d;(m=document.createElement("div")).innerHTML='<li class="TcHmi_Controls_Beckhoff_TcHmiRecipeSelect_topmost_selection_item TcHmi_Controls_Beckhoff_TcHmiRecipeSelect_topmost_selection_item_folder">..</li>',(d=path?path.split("::"):[]).pop();i=d.pop(),n=d.join("::");(a={type:r.RecipeItemType.Folder,key:i,path:n,selectionElement:m.firstElementChild}).selectionElement&&(c.append(a.selectionElement),a.selectionElement.addEventListener("click",this.__onTopMostRecipeItemClicked(a)))}for(var u=0,p=s.length;u<p;u++){var h=s[u];h.selectionElement&&c.append(h.selectionElement)}for(u=0,p=l.length;u<p;u++){var v=l[u];v.selectionElement&&c.append(v.selectionElement)}o&&(e.EventProvider.raise(this.__id+".onFunctionResultChanged",["getSelectedRecipeFullName"]),e.EventProvider.raise(this.__id+".onFunctionResultChanged",["getSelectedRecipeName"]),e.EventProvider.raise(this.__id+".onFunctionResultChanged",["getSelectedRecipePath"]))}},r.prototype.__openTopMostSelectionFolder=function(path){var t=this;this.__serverDomainIsValid&&e.Server.RecipeManagement.listRecipesEx({path:path,domain:this.__serverDomain},null,function(r){r.error===e.Errors.NONE?r.value&&t.__displayTopMostSelectionFolder(r.value,path):e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiRecipeSelect, Id="+t.getId()+"] TcHmi.Server.RecipeManagement.listRecipesEx failed. "+e.Log.buildMessage(r.details))})},r.prototype.__onTopMostRecipeItemClicked=function(e){var t=this;return function(o){var i,n,c,s,l,_,a,m,d,u;if(e.type===r.RecipeItemType.Folder)e.path?t.__openTopMostSelectionFolder(e.path+"::"+e.key):e.key?t.__openTopMostSelectionFolder(e.key):t.__openTopMostSelectionFolder();else if(e.type===r.RecipeItemType.Recipe){t.__currentSelectionRecipeTemp=e;for(var p=0,h=null===(s=null===(c=null===(n=null===(i=e)||void 0===i?void 0:i.selectionElement)||void 0===n?void 0:n.parentElement)||void 0===c?void 0:c.children)||void 0===s?void 0:s.length;p<h;p++){null===(m=null===(a=null===(_=null===(l=e)||void 0===l?void 0:l.selectionElement)||void 0===_?void 0:_.parentElement)||void 0===a?void 0:a.children[p])||void 0===m||m.classList.remove("TcHmi_Controls_Beckhoff_TcHmiRecipeSelect_topmost_selected")}null===(u=null===(d=e)||void 0===d?void 0:d.selectionElement)||void 0===u||u.classList.add("TcHmi_Controls_Beckhoff_TcHmiRecipeSelect_topmost_selected")}}},r.prototype.__onSelectDivMouseDown=function(){var t=this;return function(r){var path;t.getIsEnabled()&&(e.Access.checkAccess(t,"operate")&&(r&&0!==r.button||(t.__currentSelectionFolder&&t.__currentSelectionFolder.path&&t.__currentSelectionFolder.key?path=t.__currentSelectionFolder.path+"::"+t.__currentSelectionFolder.key:t.__currentSelectionFolder&&t.__currentSelectionFolder.key&&(path=t.__currentSelectionFolder.key),t.__topMostLayerOpened||(t.__topMostLayerOpened=!0,e.TopMostLayer.add(t,$(t.__elementTopMostSelection),{removeCb:function(e){t.__topMostLayerOpened=!1},centerHorizontal:!0,centerVertical:!0})),t.__openTopMostSelectionFolder(path))))}},r.prototype.__onBreadcrumbItemClicked=function(t){var r=this;return function(o){var path;r.__serverDomainIsValid&&(t.path?path=t.path+"::"+t.key:t.key&&(path=t.key),r.__topMostLayerOpened||(r.__topMostLayerOpened=!0,e.TopMostLayer.add(r,$(r.__elementTopMostSelection),{removeCb:function(e){r.__topMostLayerOpened=!1},centerHorizontal:!0,centerVertical:!0})),r.__openTopMostSelectionFolder(path))}},r.prototype.__onBreadcrumbScrollingContainerMouseDown=function(){var t=this;return function(r){t.__serverDomainIsValid&&t.getIsEnabled()&&e.Access.checkAccess(t,"operate")&&(r&&0!==r.button||(t.__breadcrumbScrollingMouseDown=!0))}},r.prototype.__onDocumentMouseUp=function(){var t=this;return function(r){if(t.__serverDomainIsValid&&t.getIsEnabled()&&e.Access.checkAccess(t,"operate")&&(!r||0===r.button)){if(t.__elementBreadcrumbScrollContainer&&t.__breadcrumbScrollingMouseDown)!function(e){setTimeout(function(){for(var t=0,r=e.length;t<r;t++){var o=e[t];o&&o.breadcrumbElement&&o.breadcrumbEventListenerClick&&o.breadcrumbElement.addEventListener("click",o.breadcrumbEventListenerClick)}},300)}(t.__breadcrumbItems);t.__breadcrumbScrollingMouseDown=!1}}},r.prototype.__onDocumentMouseMove=function(){var t=this;return function(r){if(t.__serverDomainIsValid&&t.getIsEnabled()&&e.Access.checkAccess(t,"operate")&&(!r||0===r.button)&&t.__elementBreadcrumbScrollContainer&&t.__breadcrumbScrollingMouseDown){t.__elementBreadcrumbScrollContainer.scrollLeft=t.__elementBreadcrumbScrollContainer.scrollLeft+-r.movementX;for(var o=t.__breadcrumbItems,i=0,n=o.length;i<n;i++){var c=o[i];c&&c.breadcrumbElement&&c.breadcrumbEventListenerClick&&c.breadcrumbElement.removeEventListener("click",c.breadcrumbEventListenerClick)}}}},r.prototype.__onTopMostButtonOKPressed=function(){var t=this;return function(r,o){t.__serverDomainIsValid&&t.getIsEnabled()&&e.Access.checkAccess(t,"operate")&&(t.__currentSelectionFolder=t.__currentSelectionFolderTemp,t.__currentSelectionRecipe=t.__currentSelectionRecipeTemp,t.__processSelection(),e.EventProvider.raise(t.__id+".onFunctionResultChanged",["getSelectedRecipeFullName"]),e.EventProvider.raise(t.__id+".onFunctionResultChanged",["getSelectedRecipeName"]),e.EventProvider.raise(t.__id+".onFunctionResultChanged",["getSelectedRecipePath"]),e.TopMostLayer.remove(t,$(t.__elementTopMostSelection)))}},r.prototype.__onTopMostButtonCancelPressed=function(){var t=this;return function(r,o){t.__serverDomainIsValid&&t.getIsEnabled()&&e.Access.checkAccess(t,"operate")&&e.TopMostLayer.remove(t,$(t.__elementTopMostSelection))}},r.prototype.__onButtonActivePressed=function(){var t=this;return function(r,o){t.__serverDomainIsValid&&t.getIsEnabled()&&e.Access.checkAccess(t,"operate")&&e.Access.checkAccess(t,"activateRecipe")&&t.__currentSelectionRecipe&&t.__currentSelectionRecipe.key&&e.Server.RecipeManagement.activateEx(t.__currentSelectionRecipe.key,t.__currentSelectionRecipe.path?t.__currentSelectionRecipe.path:null,{domain:t.__serverDomain},null,function(r){r.error!==e.Errors.NONE&&e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiRecipeSelect, Id="+t.getId()+"] TcHmi.Server.RecipeManagement.activateEx failed. "+e.Log.buildMessage(r.details))})}},r.prototype.__onButtonTeachPressed=function(){var t=this;return function(r,o){t.__serverDomainIsValid&&t.getIsEnabled()&&e.Access.checkAccess(t,"operate")&&e.Access.checkAccess(t,"teachRecipe")&&t.__currentSelectionRecipe&&t.__currentSelectionRecipe.key&&e.Server.RecipeManagement.teachEx(t.__currentSelectionRecipe.key,t.__currentSelectionRecipe.path?t.__currentSelectionRecipe.path:null,{domain:t.__serverDomain},null,function(r){r.error!==e.Errors.NONE&&e.Log.error("[Source=Control, Module=TcHmi.Controls.Beckhoff.TcHmiRecipeSelect, Id="+t.getId()+"] TcHmi.Server.RecipeManagement.teachEx failed. "+e.Log.buildMessage(r.details))})}},r}(e.Controls.System.TcHmiControl);t.TcHmiRecipeSelect=r,function(e){!function(e){e[e.Invalid=0]="Invalid",e[e.Recipe=1]="Recipe",e[e.Folder=2]="Folder"}(e.RecipeItemType||(e.RecipeItemType={}))}(r=t.TcHmiRecipeSelect||(t.TcHmiRecipeSelect={}))}(t.Beckhoff||(t.Beckhoff={})),t.registerEx("TcHmiRecipeSelect","TcHmi.Controls.Beckhoff",e.Controls.Beckhoff.TcHmiRecipeSelect)}(e.Controls||(e.Controls={}))}(TcHmi||(TcHmi={}));